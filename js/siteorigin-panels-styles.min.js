(function($,_,panelsOptions){var panels=window.siteoriginPanels;panels.view.styles=Backbone.View.extend({stylesLoaded:false,initialize:function(){},render:function(stylesType){if(typeof stylesType==="undefined"){return false}this.$el.addClass("so-visual-styles");var thisView=this;$.post(panelsOptions.ajaxurl,{action:"so_panels_style_form",type:stylesType,style:this.model.get("style")},function(response){thisView.$el.html(response);thisView.setupFields();thisView.stylesLoaded=true;thisView.trigger("styles_loaded")})},attach:function(wrapper){wrapper.append(this.$el)},detach:function(){this.$el.detach()},setupFields:function(){this.$(".style-section-wrapper").each(function(){var $s=$(this);$s.find(".style-section-head").click(function(e){e.preventDefault();$s.find(".style-section-fields").slideToggle("fast")})});if(typeof $.fn.wpColorPicker!=="undefined"){this.$(".so-wp-color-field").wpColorPicker()}this.$(".style-field-image").each(function(){var frame=null;var $s=$(this);$s.find(".so-image-selector").click(function(){if(frame===null){frame=wp.media({title:"choose",library:{type:"image"},button:{text:"Done",close:true}});frame.on("select",function(){var attachment=frame.state().get("selection").first().attributes;try{$s.find(".current-image").css("background-image","url("+attachment.sizes.thumbnail.url+")")}catch(e){$s.find(".current-image").css("background-image","url("+attachment.sizes.full.url+")")}$s.find("input").val(attachment.id)})}frame.open()});$s.find(".remove-image").click(function(){$s.find(".current-image").css("background-image","none");$s.find("input").val("")})});this.$(".style-field-measurement").each(function(){var $$=$(this);var text=$$.find('input[type="text"]');var unit=$$.find("select");var hidden=$$.find('input[type="hidden"]');if(hidden.val()!==""){var re=/([0-9\.,]+)(.*)/;var match=re.exec(hidden.val());if(match!=null&&typeof match[1]!=="undefined"&&typeof match[2]!=="undefined"){text.val(match[1]);unit.val(match[2])}}var setVal=function(){hidden.val(text.val()+unit.val())};text.keyup(setVal).change(setVal);unit.change(setVal)})}})})(jQuery,_,soPanelsOptions);